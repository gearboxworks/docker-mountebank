
################################################################################
# WARNING: This file has been auto-generated. DO NOT EDIT: WARNING
# Created on 2021-03-07T19:06:23+1100, using template:DockerfileRuntime.tmpl and json:gearbox.json
# Referenced Docker container for docker-mountebank based off gearboxworks/gearbox-base:alpine-3.10 with bbyars/mountebank:2.2.1 overlayed.

ARG VERSION=2.2.1

# 1. First reference the gearbox-base image.
FROM gearboxworks/gearbox-base:alpine-3.10 as gearbox-base

# 2. Next reference the third party image.
FROM bbyars/mountebank:2.2.1
ARG VERSION
ARG GEARBOX_ENTRYPOINT
ARG GEARBOX_ENTRYPOINT_ARGS
USER root

# 3. Copy the build directory over from gearbox-base image.
COPY --from=gearbox-base /etc/gearbox /etc/gearbox

# 4. Set up env variables.
MAINTAINER Gearbox Team <team@gearbox.works>
ENV GEARBOX_CONTAINER_NAME "docker-mountebank"
ENV GEARBOX_CONTAINER_VERSION ${VERSION}
ENV GEARBOX_ENTRYPOINT ${GEARBOX_ENTRYPOINT}
ENV GEARBOX_ENTRYPOINT_ARGS ${GEARBOX_ENTRYPOINT_ARGS}
LABEL gearbox.json='{"schema": "gear-1","meta": {"state": "production","organization": "gearboxworks","name": "mountebank","label": "mountebank","info": "MB","description": ["mountebank is the most capable open source service virtualization tool in existence, and will cure what ails you, guaranteed."],"maintainer": "Gearbox Team <team@gearbox.works>","class": "system","refurl": "https://github.com/mountebank"},"build": {"ports": {"mb": "2525"},"run": "/usr/local/bin/mb.sh","args": "start","env": {"MB_HOSTNAME": "mountebank.gearboxworks.io","MB_BIND_ADDR": "0.0.0.0:2525"},"network": "--network gearboxnet","volumes": "","restart": "--restart always"},"run": {"commands": {"default": "/usr/local/bin/mb.sh","mb": "/usr/local/bin/mb.sh"},"args": "start --nologfile"},"project": {},"extensions": {},"versions": {"2.4.0": {"majorversion": "2.4","latest": true,"ref": "bbyars/mountebank:2.4.0","base": "gearboxworks/gearbox-base:alpine-3.10"},"2.3.3": {"majorversion": "2.3","latest": false,"ref": "bbyars/mountebank:2.3.3","base": "gearboxworks/gearbox-base:alpine-3.10"},"2.2.1": {"majorversion": "2.2","latest": false,"ref": "bbyars/mountebank:2.2.1","base": "gearboxworks/gearbox-base:alpine-3.10"}}}'
LABEL gearbox.version='2.2.1'
ENV GEARBOX_VERSION "2.2.1"
LABEL container.class="system"
ENV GEARBOX_CLASS "system"
LABEL container.description="[mountebank is the most capable open source service virtualization tool in existence, and will cure what ails you, guaranteed.]"
ENV GEARBOX_DESCRIPTION "[mountebank is the most capable open source service virtualization tool in existence, and will cure what ails you, guaranteed.]"
LABEL container.info="MB"
ENV GEARBOX_INFO "MB"
LABEL container.label="mountebank"
ENV GEARBOX_LABEL "mountebank"
LABEL container.maintainer="Gearbox Team <team@gearbox.works>"
ENV GEARBOX_MAINTAINER "Gearbox Team <team@gearbox.works>"
LABEL container.name="mountebank"
ENV GEARBOX_NAME "mountebank"
LABEL container.organization="gearboxworks"
ENV GEARBOX_ORGANIZATION "gearboxworks"
LABEL container.refurl="https://github.com/mountebank"
ENV GEARBOX_REFURL "https://github.com/mountebank"
LABEL container.state="production"
ENV GEARBOX_STATE "production"
LABEL container.args="start"
ENV GEARBOX_ARGS "start"
# SKIP env
LABEL container.network="--network gearboxnet"
ENV GEARBOX_NETWORK "--network gearboxnet"
LABEL container.ports="map[mb:2525]"
ENV GEARBOX_PORTS "map[mb:2525]"
LABEL container.restart="--restart always"
ENV GEARBOX_RESTART "--restart always"
LABEL container.run="/usr/local/bin/mb.sh"
ENV GEARBOX_RUN "/usr/local/bin/mb.sh"
LABEL container.volumes=""
ENV GEARBOX_VOLUMES ""
LABEL container.base="gearboxworks/gearbox-base:alpine-3.10"
ENV GEARBOX_BASE "gearboxworks/gearbox-base:alpine-3.10"
LABEL container.latest="false"
ENV GEARBOX_LATEST "false"
LABEL container.majorversion="2.2"
ENV GEARBOX_MAJORVERSION "2.2"
LABEL container.ref="bbyars/mountebank:2.2.1"
ENV GEARBOX_REF "bbyars/mountebank:2.2.1"
ENV MB_BIND_ADDR "0.0.0.0:2525"
ENV MB_HOSTNAME "mountebank.gearboxworks.io"

# 5. Now copy the local files specific to this container.
COPY build /etc/gearbox
COPY versions/${VERSION}/build /etc/gearbox

# 6. Run the base.sh script to set everything up.
RUN /bin/sh /etc/gearbox/build/base.sh

# 7. Run the mountebank.sh script to set everything up.
RUN /bin/sh /etc/gearbox/build/mountebank.sh

# 8. Expose ports.
EXPOSE 22 9970 2525 
WORKDIR /home/gearbox/projects

CMD ["/init"]

# END
################################################################################
